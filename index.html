<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="nom.css">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-responsive-min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <title>Nightlife on Mars</title>
</head>

<body>
  <div class="pure-g">
    <img src='images/nom_banner.jpg'>
    <div class="pure-u-lg-1 pure-u-sm-1">
      <p>Thanks so much for supporting Nightlife on Mars! We hope you enjoyed the show.</p>
      <p></p>If you would like to tip us, please consider one of the following methods:</p>
    </div>
    <div class="pure-u-1 venmo">
      <a href="https://venmo.com/red-scott" target="_blank">
        <img src="images/venmo.png">
      </a>
    </div>
    <div class="pure-u-1 paypal">
      <a href="https://paypal.me/vietjew" target="_blank">
        <img src="images/paypal.png">
      </a>
    </div>

    <!-- Load Stripe.js on your website. -->
    <script src="https://js.stripe.com/v3"></script>

    <!-- Create a button that your customers click to complete their purchase. Customize the styling to suit your branding. -->

    <div class="pure-u-1">
      <h3>Credit Card</h3>
      <p>If you don't have an account for Venmo or Paypal, you can tip with a credit card. Enter the amount you want to tip (whole dollar amounts only) and click the button.</p>
      <p><em>You will be redirected to Stripe to complete payment</em></p>
      Tip amount: <input type="text" id="tip-input" size="3">
      <br /><br />
      <!-- <p>Tip $<span id="tip-amount">0</span></p> -->
      <button
        style="background-color:#6772E5;color:#FFF;padding:8px 12px;border:0;border-radius:4px;font-size:1em"
        id="checkout-button-price_1GtUKDIaxOJy55IKUyGt8DX9"
        role="link"
      >
        Tip $<span id="tip-amount">1</span>
      </button>

      <div id="error-message"></div>
    </div>

  </div>
  <script>
    $("#tip-input").on("keyup", function(e) {
      var inputAmount = $(e.target).val();
      var tipAmount = parseInt(inputAmount);
      if (Number.isNaN(tipAmount)) {
        tipAmount = 1;
      }
      $('#tip-amount').text(tipAmount);
    });
    (function() {
      var stripe = Stripe('pk_test_51GtSh8IaxOJy55IKx2NsaU7bOnhGWb8v9VvGdrOuwz5Qk45cPhSBNpVrch82DPHYUQKFCYOkRgDtZWp0GHMRVZiH00Pavp5ura');
      var checkoutButton = document.getElementById('checkout-button-price_1GtUKDIaxOJy55IKUyGt8DX9');
      checkoutButton.addEventListener('click', function () {
        // When the customer clicks on the button, redirect
        // them to Checkout.
        var tipInput = $('#tip-input').val();
        var tipQuantity = parseInt(tipInput);
        if (Number.isNaN(tipQuantity)) {
          tipQuantity = 1;
        }
        console.log(tipQuantity);
        stripe.redirectToCheckout({
          lineItems: [{price: 'price_1GtUKDIaxOJy55IKUyGt8DX9', quantity: tipQuantity}],
          mode: 'payment',
          // Do not rely on the redirect to the successUrl for fulfilling
          // purchases, customers may not always reach the success_url after
          // a successful payment.
          // Instead use one of the strategies described in
          // https://stripe.com/docs/payments/checkout/fulfillment
          successUrl: window.location.protocol + '//tips.nightlifeonmars.com/success',
          cancelUrl: window.location.protocol + '//tips.nightlifeonmars.com/',
        })
        .then(function (result) {
          if (result.error) {
            // If `redirectToCheckout` fails due to a browser or network
            // error, display the localized error message to your customer.
            var displayError = document.getElementById('error-message');
            displayError.textContent = result.error.message;
          }
        });
      });
    })();
  </script>
</body>
</html>
